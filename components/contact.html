<li id="contact" class="l-section section">
  <div class="contact">
    <h2>Contact us</h2>
    <div class="contact--lockup">
      <div class="modal">
        <div class="modal--information">
            <div class="info-item d-flex" data-aos="fade-up" data-aos-delay="200">
              <i class="bi bi-geo-alt flex-shrink-0"></i>
              <div>
                <h3>Address</h3>
                <span>Cit√© des Sciences, Tunis, Tunisie</span>
              </div>
            </div>

            <div class="info-item d-flex" data-aos="fade-up" data-aos-delay="300">
              <i class="bi bi-telephone flex-shrink-0"></i>
              <div>
                <h3>Call Us</h3>
                <span>Louay Sahbani: +216 50356714</span><br>
                <span>Amine Elyanoubli: +216 58187043</span>
              </div>
            </div>
            
            <div class="info-item d-flex" data-aos="fade-up" data-aos-delay="400">
              <i class="bi bi-envelope flex-shrink-0"></i>
              <div>
                <h3>Email Us</h3>
                <p><a href="mailto:louaysahbani@ieee.org">louaysahbani@ieee.org</a></p>
                <p><a href="mailto:mohamedamine_elyanoubli@ieee.org">mohamedamine_elyanoubli@ieee.org</a></p>
              </div>
            </div>

            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3192.702999308886!2d10.185942174700699!3d36.84958846491582!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x12fd34b9dee763fd%3A0xdca263934c8cca90!2sTunis%20Science%20City!5e0!3m2!1sfr!2stn!4v1723750836486!5m2!1sfr!2stn" 
            width="400" height="300" style="border:0;" 
            allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
        
        </div>
      </div>
      <div class="modal2">
        <div class="modal--information">
          <p>
            If you have any questions, concerns, or feedback,
            please don't hesitate to get in touch with our friendly support team.<br>
            We're here to assist you in any way we can!
          </p>
          <form id="form" class="contact-from">
            <div class="form-group">
              <input id="firstName" type="text" spellcheck="false">
              <label for="firstName">FirstName</label>
            </div>
            
            <div class="form-group">
              <input id="lastName" type="text" spellcheck="false">
              <label for="lastName">LastName</label>
            </div>
      
            <div class="form-group">
              <input id="email" type="text" spellcheck="false">
              <label for="email">Email Address:</label>
            </div>
      
            <div class="form-group">
              <input id="subject" type="text" spellcheck="false">
              <label for="subject">Subject</label>
            </div>
      
            <div class="form-group">
              <textarea id="message" name="message" spellcheck="false"></textarea>
              <label for="message">Message</label>
            </div>
            <button type="submit" class="submit-btn btn btn-primary">Submit</button>
          </form>
          <div
          id="message"
          style="
            display: none;
            margin: 20px;
            font-weight: bold;
            color: green;
            padding: 8px;
            background-color: beige;
            border-radius: 4px;
            border-color: aquamarine;
          "
        ></div>
        </div>
      </div>
    </div>
  </div>
  <script>
    document.getElementById("form").addEventListener("submit", async function (e) {
   e.preventDefault(); 
   document.getElementById("message").textContent = "Submitting..";
   document.getElementById("message").style.display = "block";
   document.getElementById("submit-button").disabled = true;
 
   const email = document.getElementById("email").value;
 
   const existingEmails = await fetchEmails();
 
   if (existingEmails.includes(email)) {
     document.getElementById("message").textContent =
       "This email is already registered. Please use a different email.";
     document.getElementById("message").style.display = "block";
     document.getElementById("message").style.backgroundColor = "red";
     document.getElementById("message").style.color = "white";
     document.getElementById("submit-button").disabled = false;
     return;
   }
   var formData = new FormData(this);
   var keyValuePairs = [];
   for (var pair of formData.entries()) {
     keyValuePairs.push(pair[0] + "=" + pair[1]);
   }
 
   var formDataString = keyValuePairs.join("&");
 
   fetch(
     "https://script.google.com/macros/s/AKfycbxZKBOH2Wd-Ssw6gJjNJkToSsSZQNxaBBP3XpUrmwtC72DdblX4YjmEbafs2K_zLWI/exec",
     {
       redirect: "follow",
       method: "POST",
       body: formDataString,
       headers: {
         "Content-Type": "text/plain;charset=utf-8",
       },
     }
   )
     .then(function (response) {
       if (response) {
         return response; 
       } else {
         throw new Error("Failed to submit the form.");
       }
     })
     .then(function (data) {
       document.getElementById("message").textContent =
         "Data submitted successfully!";
       document.getElementById("message").style.display = "block";
       document.getElementById("message").style.backgroundColor = "green";
       document.getElementById("message").style.color = "beige";
       document.getElementById("submit-button").disabled = false;
       document.getElementById("form").reset();
 
       setTimeout(function () {
         document.getElementById("message").textContent = "";
         document.getElementById("message").style.display = "none";
       }, 2600);
     })
     .catch(function (error) {
       console.error(error);
       document.getElementById("message").textContent =
         "An error occurred while submitting the form.";
       document.getElementById("message").style.display = "block";
     });
 });
 
 async function fetchEmails() {
   try {
     const response = await fetch(
       "https://script.google.com/macros/s/AKfycbxZKBOH2Wd-Ssw6gJjNJkToSsSZQNxaBBP3XpUrmwtC72DdblX4YjmEbafs2K_zLWI/exec" // Replace with your Google Apps Script URL
     );
     const data = await response.json();
     return data.emails;
   } catch (error) {
     console.error("Error fetching emails:", error);
     return [];
   }
 }
   </script>
</li>




